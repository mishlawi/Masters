---
  - hosts: localhost
    connection: local
    vars_files:
      - vars.yml
    tasks:
      - name: creating instance on GCP
        gcp_compute_instance:
          name: "{{ vm_name }}"
          tags:
            items:
              - http-server
              - https-server
          machine_type: e2-medium
          disks:
            - auto_delete: true
              boot: true
              initialize_params:
                disk_size_gb: 50
                source_image: projects/ubuntu-os-cloud/global/images/ubuntu-minimal-2004-focal-v20211209
          network_interfaces:
            - access_configs:
              - name: External NAT
                type: ONE_TO_ONE_NAT
          metadata:
            ssh-keys: "melanipereira98:{{ lookup('file',  '~/.ssh/id_rsa.pub') }}"
          zone: "{{ zone }}"
          project: "{{ project }}"
          auth_kind: "{{ auth_kind }}"
          service_account_file: "{{ file }}"
          state: present    

